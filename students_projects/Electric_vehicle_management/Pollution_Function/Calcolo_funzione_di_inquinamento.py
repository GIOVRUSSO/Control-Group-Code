from numpy import *
from scipy.interpolate import *
from matplotlib.pyplot import *

y=[]
prova=[]
x=[]

Velocita=[1.5877379182630769, 1.3424194733248742, 1.0289405123875723, 1.0673970814854443, 1.0472073643521234,0.0, 2.596356180612929, 4.791554176737554, 6.4741341718938195, 8.219600459374487, 9.93205141336657, 11.30091070968192, 13.51138258324936, 15.100240314612163, 1.6423656644299607, 1.2988649287495142, 1.814484716712968, 1.2478821232153152, 1.6269173179093075, 3.320393022311914, 2.6987788801072785, 3.610171611676055, 2.8308266213155044, 3.1241860006228714, 2.7029025596324976, 3.3352798908940207, 2.640375148434254, 3.1052395125842347,6.4741341718938195, 7.6252860560394655, 7.592270722550881, 7.248679064874148, 8.090291642126237, 7.468677499921602, 8.380070231490379, 7.600725241129828, 7.894084620437195, 7.472801179446821, 8.105178510708345, 7.410273768248578, 7.63047259944359, 14.88851979741055, 15.799912528979327, 15.020567538618776, 15.050314896932537, 15.205850082549002, 15.389381948701772, 14.882861297141496, 14.892423211673009,11.30091070968192, 13.390178997475486, 12.768564855270851, 13.679957586839627, 12.900612596479077, 12.930359954792838, 13.085895140409303, 13.269427006562072, 12.762906355001796, 12.77246826953331, 0.0, 4.791554176737554, 5.442444821575364, 5.505331113899766, 5.472315780411182, 5.128724122734448, 5.970336699986538, 5.348722557781903, 6.260115289350679, 5.480770298990128, 5.774129678297496, 5.352846237307122, 5.985223568568645, 5.290318826108878, 5.755183190258859,  2.596356180612929, 2.7751304093341744, 2.262512408365815, 2.3253987006902164, 2.2923833672016327, 1.9487917095248988, 2.790404286776989, 2.1687901445723536, 3.08018287614113, 2.3008378857805796, 2.5941972650879466, 2.1729138240975727, 2.805291155359096, 2.110386412899329, 2.57525077704931,9.93205141336657, 10.312013956266014, 11.153626533518104, 10.532012391313469, 11.443405122882245, 10.664060132521694, 10.95741951182906, 10.693807490835455, 10.84934267645192, 11.03287454260469, 10.526353891044414]
Emissioni=[3095.620033191304, 0.0, 0.0, 2505.8711999772495, 0.0,2624.722222222222, 4097.933423236939, 4925.045056968368, 4953.238270727893, 5828.38336147156, 6543.864872705594, 6193.302774873136, 10089.905513471873, 8709.350996972657, 2535.201634069282, 0.0, 2659.0134365972744, 0.0, 2595.1499766619713, 3008.8765219102233, 0.0, 3116.2815733664843, 0.0, 2534.882728581365, 0.0, 2829.0802848561416, 0.0, 2673.7874113082144, 4953.238270727893, 4379.875642846214, 0.0, 0.0, 3863.662482374407, 0.0, 4079.5297056115533, 0.0, 2693.3026808119234, 0.0, 3424.8276935084987, 0.0, 2529.7053282339634, 7777.618788390792, 6287.916437844944, 0.0, 2566.765215545224, 3083.3118287536895, 3223.327445168833, 0.0, 2470.5557767086634,6193.302774873136, 9587.153413135076, 0.0, 5568.749949288687, 0.0, 2359.746437837285, 2801.6057748044636, 2920.041836288444, 0.0, 2279.9466624526212, 2624.722222222222, 4925.045056968368, 3074.4787141906227, 2238.5739456171177, 0.0, 0.0, 3439.6581856693474, 0.0, 3607.3199992261007, 0.0, 2578.7943877662537, 0.0, 3115.95164205314, 0.0, 2835.378227383145, 4097.933423236939, 2454.4270550866618, 0.0, 2403.569224985994, 0.0, 0.0, 2935.9500167746905, 0.0, 3031.303715810854, 0.0, 2539.33022436068, 0.0, 2784.9358410330356, 0.0, 2654.6990757095223,6543.864872705594, 3142.827492420585, 4600.992189017361, 0.0, 4886.516229242674, 0.0, 2983.4106621670576, 0.0, 2580.8928132688684, 2676.56244430047, 0.0]
Spazio_Percorso=[1.5, 1.32, 1, 1.12, 1.05,2.5, 4.8, 6.4, 8.2, 10, 11.3, 13.5, 15.1, 16.8, 1.6, 1.3, 1.9, 1.2, 1.6, 3.3, 2.89, 3.6, 32.9, 3.1, 2.7, 3.3, 2.7, 3.1, 6.48, 7.62, 7.6, 7.23, 8.5, 7.4, 8.4, 7.6, 8.0, 7.7, 8.1, 7.3, 7.6, 15, 15, 15, 15, 15, 15, 15, 15, 13.1, 12.9, 13.5, 12.5, 13.3, 13.0, 12.8, 13.6, 13.1, 13.0, 3, 5.2, 4.9, 5.8, 5.7, 6.1, 6.0, 5.72, 5.65, 6.12, 6.00, 5.91, 5.86, 5.71, 5.78, 2.5, 2.8, 2.3, 2.3, 2.3, 2.00, 2.7, 2.2, 3.1, 2.3, 2.6, 2.2, 2.8, 2.1, 2.5, 9.93, 10.31, 11.15, 8.54, 11.44, 10.66, 10.87, 10.77, 10.9, 10.8, 10.55]

print('Velocita:', len(Velocita))
print(len(Emissioni))
print(len(Spazio_Percorso))

i=0
for i in range(len(Emissioni)):
    y.append(Emissioni[i]/Spazio_Percorso[i])

p2=polyfit(Velocita,y,2)
print(p2)

f2 = interp1d(Velocita,polyval(p2,Velocita))
#plot(Velocita,f2(Velocita),'o')
#xlabel("Velocita m/s")
#ylabel("Emissioni mg/m")
#show()

i=0
for i in range(0,1600,1):
    x.append(i/100)
print(len(x))

i=0
for i in range(0,len(x)):
    prova.append(4.29808761*x[i]*x[i] - 101.57881278*x[i] + 843.08021387)

print(prova)

plot(x,prova)
xlabel("Speed m/s")
ylabel("CO2 Emissions mg/m")
show()
